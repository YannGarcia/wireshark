# itsis.cnf
# ITSIS conformation file

# $Id$

#.OPT
PER
UNALIGNED
#.END

#.EXPORTS

#.PDU
MAPEM
SPATEM
IVIM
SREM
SSEM

#.MAKE_ENUM
DSRCmsgID
RegionId

#.FN_BODY TimestampIts
#  offset = dissect_per_constrained_integer_64b(tvb, offset, actx, tree, hf_index, 0U, G_GUINT64_CONSTANT(4398046511103), NULL, FALSE);
#.END

#.FN_BODY DangerousGoodsExtended/companyName
  offset=dissect_per_octet_string(tvb, offset, actx, tree, hf_index, NO_BOUND, NO_BOUND, FALSE, NULL);
#.END

#====================================== DSRCmsgID
#.FN_PARS DSRCmsgID VAL_PR = &Ref_DSRCmsgID
#.FN_FTR DSRCmsgID
  if (tree) {
    proto_item_append_text(proto_item_get_parent_nth(actx->created_item, 2), ": %s", val_to_str(Ref_DSRCmsgID, VALS(itsis_DSRCmsgID_vals), "unknown (%d)"));
  }
#.END
#.FN_PARS MessageFrame/value FN_VARIANT=_pdu_new  TYPE_REF_FN=dissect_messageframe_pdu_type

#====================================== RegionId
#.FN_PARS RegionId VAL_PR = &Ref_RegionId
#.FN_FTR RegionId
  if (tree) {
    proto_item_append_text(proto_item_get_parent_nth(actx->created_item, 2), ": %s", val_to_str(Ref_RegionId, VALS(itsis_RegionId_vals), "unknown (%d)"));
  }
#.END
#.FN_PARS RegionalExtension/regExtValue FN_VARIANT=_pdu_new  TYPE_REF_FN=dissect_regionalextension_pdu_type

#.FN_BODY MapData
  col_append_fstr(actx->pinfo->cinfo, COL_INFO, " (ETSI TS 103301)");

  %(DEFAULT_BODY)s

#.FN_BODY SPAT
  col_append_fstr(actx->pinfo->cinfo, COL_INFO, " (ETSI TS 103301)");

  %(DEFAULT_BODY)s

#.FN_BODY IviStructure
  col_append_fstr(actx->pinfo->cinfo, COL_INFO, " (ETSI TS 103301)");

  %(DEFAULT_BODY)s

#.FN_BODY SignalRequestMessage
  col_append_fstr(actx->pinfo->cinfo, COL_INFO, " (ETSI TS 103301)");

  %(DEFAULT_BODY)s

#.FN_BODY SignalStatusMessage
  col_append_fstr(actx->pinfo->cinfo, COL_INFO, " (ETSI TS 103301)");

  %(DEFAULT_BODY)s

#.END

#.ASSIGN_VALUE_TO_TYPE  # ISO_TS_19091_DSRC ASN.1 does not have constants assigned to types

#DSRCmsgID
mapData                           DSRCmsgID
signalPhaseAndTimingMessage       DSRCmsgID
signalRequestMessage              DSRCmsgID
signalStatusMessage               DSRCmsgID

#RegionId
noRegion     RegionId
addGrpA      RegionId
addGrpB      RegionId
addGrpC      RegionId

#.END

#.REGISTER_NEW

MapData				N dsrc.dsrcmsgid mapData
SPAT       			N dsrc.dsrcmsgid signalPhaseAndTimingMessage
SignalRequestMessage		N dsrc.dsrcmsgid signalRequestMessage
SignalStatusMessage		N dsrc.dsrcmsgid signalStatusMessage

#RegionalExtension N dsrc.regionid noRegion
#RegionalExtension N dsrc.regionid addGrpA
#RegionalExtension N dsrc.regionid addGrpB
#RegionalExtension N dsrc.regionid addGrpC

#.END
